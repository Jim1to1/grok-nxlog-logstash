Condition
Will only attempt to run if the message includes the string CPLogToSyslog
Configuration
grok_pattern: ^%{DAY}%{SPACE}%{MONTH}%{SPACE}%{MONTHDAY}%{SPACE}%{TIME}%{SPACE}%{DATA}%{SPACE}CPLogToSyslog:%{SPACE}ContentVersion: 5; Uuid: %{DATA}; SequenceNum: %{DATA}; Flags: %{DATA}; Action: %{DATA:CKP_Action}; Origin: %{DATA}; IfDir: %{DATA}; InterfaceName: %{DATA:CKP_InterfaceName}; Alert: %{DATA}; LogId: %{DATA}; OriginSicName: %{DATA}; OriginSicName: %{DATA}; log_type: %{DATA}; is_first_for_luuid: %{DATA}; ?(inzone: %{DATA}; )??(outzone: %{DATA}; )??(service_id: %{DATA}; )?src: %{DATA:CKP_src}; dst: %{DATA:CKP_dst}; proto: %{DATA}; ?(xlatesrc: %{DATA:CKP_xlatesrc}; )??(NAT_rulenum: %{DATA:CKP_NAT_rulenum}; )??(NAT_addtnl_rulenum: %{DATA}; )?match_id: %{DATA}; ?(match_table.match_id: %{DATA}; )?layer_uuid: %{DATA}; match_table.layer_uuid: %{DATA}; layer_name: %{DATA:CKP_layer_name}; match_table.layer_name: %{DATA}; rule_uid: %{DATA}; match_table.rule_uid: %{DATA}; rule_name: %{DATA:CKP_rule_name}; match_table.rule_name: %{DATA}; rule_action: %{DATA}; match_table.rule_action: %{DATA}; parent_rule: %{DATA}; match_table.parent_rule: %{DATA}; aba_customer: %{DATA}; date: %{DATA}; hour: %{DATA}; type: %{DATA}; Interface: %{DATA}; ProductName: %{DATA}; svc: %{DATA:CKP_svc}; sport_svc: %{DATA:CKP_sport_svc};?( xlatedport_svc: %{DATA};)??( xlatesport_svc: %{DATA};$)?
